/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return n};var r,n={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(r){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),s=new M(n||[]);return a(i,"_invoke",{value:j(t,r,s)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}n.wrap=f;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function _(){}var x={};h(x,u,(function(){return this}));var k=Object.getPrototypeOf,L=k&&k(k(I([])));L&&L!==o&&i.call(L,u)&&(x=L);var E=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(e,r){function n(o,a,s,u){var c=p(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==t(h)&&i.call(h,"__await")?r.resolve(h.__await).then((function(t){n("next",t,s,u)}),(function(t){n("throw",t,s,u)})):r.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,u)}))}u(c.arg)}var o;a(this,"_invoke",{value:function(t,e){function i(){return new r((function(r,o){n(t,e,r,o)}))}return o=o?o.then(i,i):i()}})}function j(t,e,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:r,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=p(t,e,n);if("normal"===c.type){if(o=n.done?m:d,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function O(t,e){var n=e.method,o=t.iterator[n];if(o===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=r,O(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,g;var a=i.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,g):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(i.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=r,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=_,a(E,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:w,configurable:!0}),w.displayName=h(_,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,h(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},n.awrap=function(t){return{__await:t}},S(P.prototype),h(P.prototype,c,(function(){return this})),n.AsyncIterator=P,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var a=new P(f(t,e,r,o),i);return n.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),h(E,l,"Generator"),h(E,u,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},n.values=I,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,o){return s.type="throw",s.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:I(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),g}},n}function r(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function n(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var a=t.apply(e,n);function s(t){r(a,o,i,s,u,"next",t)}function u(t){r(a,o,i,s,u,"throw",t)}s(void 0)}))}}var o="stories",i=function(){return new Promise((function(t,e){var r=indexedDB.open("dicoding-story-app-db",1);r.onerror=function(t){e(new Error("Gagal membuka database: ".concat(t.target.errorCode)))},r.onsuccess=function(e){t(e.target.result)},r.onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains(o)||e.createObjectStore(o,{keyPath:"id"})}}))},a=function(){var t=n(e().mark((function t(r){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&r.id){t.next=2;break}return t.abrupt("return",Promise.reject(new Error("Objek cerita atau ID cerita tidak valid.")));case 2:return t.next=4,i();case 4:return n=t.sent,t.abrupt("return",new Promise((function(t,e){var i=n.transaction([o],"readwrite").objectStore(o).put(r);i.onsuccess=function(){t(i.result)},i.onerror=function(t){e(new Error("Gagal menyimpan cerita: ".concat(t.target.error.name)))}})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s=function(){var t=n(e().mark((function t(){var r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i();case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,e){var n=r.transaction([o],"readonly").objectStore(o).getAll();n.onsuccess=function(){t(n.result)},n.onerror=function(t){e(new Error("Gagal mengambil semua cerita: ".concat(t.target.error.name)))}})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),u=function(){var t=n(e().mark((function t(r){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",Promise.reject(new Error("ID cerita tidak valid.")));case 2:return t.next=4,i();case 4:return n=t.sent,t.abrupt("return",new Promise((function(t,e){var i=n.transaction([o],"readonly").objectStore(o).get(r);i.onsuccess=function(){t(i.result)},i.onerror=function(t){e(new Error("Gagal mengambil cerita: ".concat(t.target.error.name)))}})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),c=function(){var t=n(e().mark((function t(r){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",Promise.reject(new Error("ID cerita tidak valid.")));case 2:return t.next=4,i();case 4:return n=t.sent,t.abrupt("return",new Promise((function(t,e){var i=n.transaction([o],"readwrite").objectStore(o).delete(r);i.onsuccess=function(){t()},i.onerror=function(t){e(new Error("Gagal menghapus cerita: ".concat(t.target.error.name)))}})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(){y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new M(n||[]);return o(a,"_invoke",{value:j(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var p="suspendedStart",d="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function _(){}var x={};c(x,a,(function(){return this}));var k=Object.getPrototypeOf,L=k&&k(k(I([])));L&&L!==r&&n.call(L,a)&&(x=L);var E=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,i,a,s){var u=f(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==l(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?m:d,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(l(e)+" is not iterable")}return w.prototype=_,o(E,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:w,configurable:!0}),w.displayName=c(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,c(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),c(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new P(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),c(E,u,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function d(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){d(i,n,o,a,s,"next",t)}function s(t){d(i,n,o,a,s,"throw",t)}a(void 0)}))}}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function g(t){var e=function(t){if("object"!=l(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}const b=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._authAPI=r.authAPI,this._authService=r.authService,this._stories=[],this._savedStoryIds=new Set},e=[{key:"onViewReady",value:(c=v(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._authService.isUserLoggedIn();case 2:if(t.sent){t.next=5;break}return this._view.navigateToLogin(),t.abrupt("return");case 5:return t.next=7,this._loadInitialStories();case 7:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"_loadInitialStories",value:(u=v(y().mark((function t(){var e,r;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showMainLoading(!0),this._view.clearStoryListAndMessages(),this._view.showMapMessage(!0,"Memuat data peta..."),e=!1,t.next=6,this._loadSavedStoryIds();case 6:return t.prev=6,t.next=9,s();case 9:(r=t.sent)&&r.length,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(6),console.error("HomePagePresenter: Error fetching stories from IndexedDB:",t.t0);case 16:return t.next=18,this._fetchStoriesFromNetwork(e);case 18:case"end":return t.stop()}}),t,this,[[6,13]])}))),function(){return u.apply(this,arguments)})},{key:"_fetchStoriesFromNetwork",value:(i=v(y().mark((function t(e){var r,n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e||this._view.showMainLoading(!0),t.prev=1,t.next=4,this._authService.getToken();case 4:return r=t.sent,t.next=7,this._authAPI.getAllStories(r,{page:1,size:20,location:0});case 7:(n=t.sent).error?e||0!==this._stories.length?e&&this._view.displayInfoMessage("Gagal mengambil versi terbaru. Menampilkan data tersimpan."):(this._view.displayMainError(n.message||"Gagal memuat cerita."),this._view.showMapMessage(!1,"Gagal memuat data lokasi cerita.")):n.listStory?(this._stories=n.listStory,this._view.clearMessage(),this._view.renderStoryList(this._stories,this._savedStoryIds),this._updateMapFromStories(this._stories)):e||0!==this._stories.length||(this._view.displayMainError("Data cerita tidak ditemukan dari server."),this._view.showMapMessage(!1,"Data cerita tidak tersedia untuk peta.")),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e||0!==this._stories.length?e&&this._view.displayInfoMessage("Gagal terhubung ke jaringan. Menampilkan data tersimpan."):(this._view.displayMainError(t.t0.message||"Terjadi kesalahan saat mengambil data cerita."),this._view.showMapMessage(!1,"Terjadi kesalahan saat memuat data lokasi."));case 14:return t.prev=14,this._view.showMainLoading(!1),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))),function(t){return i.apply(this,arguments)})},{key:"_updateMapFromStories",value:function(t){var e=t.filter((function(t){return null!=t.lat&&null!=t.lon&&0!==t.lat&&0!==t.lon}));e.length>0?(this._view.showMapMessage(!1),this._view.initializeMapAndMarkers(e)):this._view.showMapMessage(!1,"Tidak ada cerita dengan data lokasi untuk ditampilkan di peta.")}},{key:"_loadSavedStoryIds",value:(o=v(y().mark((function t(){var e;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s();case 3:e=t.sent,this._savedStoryIds=new Set(e.map((function(t){return t.id}))),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),this._savedStoryIds=new Set;case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return o.apply(this,arguments)})},{key:"handleSaveStoryRequest",value:(n=v(y().mark((function t(e){var r,n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this._stories.find((function(t){return t.id===e}))){t.next=4;break}return this._view.displayMessage("Gagal menemukan data cerita untuk disimpan. Coba refresh halaman.",!0),t.abrupt("return");case 4:if(!this._savedStoryIds.has(r.id)){t.next=7;break}return this._view.displayMessage("Cerita ini sudah tersimpan.",!1,!0),t.abrupt("return");case 7:return this._view.displayMessage('Menyimpan cerita "'.concat(r.name.substring(0,20),'..."'),!1,!0),t.prev=8,n=f(f({},r),{},{savedAt:(new Date).toISOString()}),t.next=12,a(n);case 12:this._savedStoryIds.add(r.id),this._view.updateSaveButtonState(r.id,!0),this._view.displayMessage('Cerita "'.concat(r.name.substring(0,20),'..." berhasil disimpan!'),!1),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(8),this._view.displayMessage("Gagal menyimpan cerita offline.",!0);case 20:case"end":return t.stop()}}),t,this,[[8,17]])}))),function(t){return n.apply(this,arguments)})},{key:"handleClearOfflineStoriesRequest",value:(r=v(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Tombol Hapus Semua Cerita Offline di Beranda akan diubah fungsinya."),this._view.displayInfoMessage('Fitur hapus semua cerita telah dipindahkan ke halaman "Cerita Tersimpan".',!0);case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&m(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,u,c}(),w="https://story-api.dicoding.dev/v1";function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function x(){x=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new M(n||[]);return o(a,"_invoke",{value:j(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var k=Object.getPrototypeOf,L=k&&k(k(I([])));L&&L!==r&&n.call(L,a)&&(w=L);var E=b.prototype=m.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),c(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new P(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),c(E,u,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function k(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function E(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){k(i,n,o,a,s,"next",t)}function s(t){k(i,n,o,a,s,"throw",t)}a(void 0)}))}}const S={login:function(t){return E(x().mark((function e(){var r,n,o,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,n=t.password,e.prev=1,e.next=4,fetch("".concat(w,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:n})});case 4:if(o=e.sent,i=o.headers.get("content-type"),!(o.ok&&i&&i.includes("application/json"))){e.next=8;break}return e.abrupt("return",o.json());case 8:return e.next=10,o.text();case 10:throw a=e.sent,new Error(a||"HTTP error! status: ".concat(o.status));case 14:return e.prev=14,e.t0=e.catch(1),console.error("AuthAPI.login: Catch block error:",e.t0),e.abrupt("return",{error:!0,message:e.t0.message||"Gagal terhubung ke server atau memproses respons."});case 18:case"end":return e.stop()}}),e,null,[[1,14]])})))()},register:function(t){return E(x().mark((function e(){var r,n,o,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,n=t.email,o=t.password,e.prev=1,e.next=4,fetch("".concat(w,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:n,password:o})});case 4:return i=e.sent,e.next=7,i.json();case 7:return a=e.sent,e.abrupt("return",a);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",{error:!0,message:e.t0.message||"Gagal terhubung ke server saat registrasi."});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))()},getAllStories:function(t){var e=arguments;return E(x().mark((function r(){var n,o,i,a,s,u,c,l,h,f;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=(n=e.length>1&&void 0!==e[1]?e[1]:{}).page,i=void 0===o?1:o,a=n.size,s=void 0===a?10:a,u=n.location,c=void 0===u?0:u,r.prev=1,l=new URLSearchParams({page:i,size:s,location:c}),r.next=5,fetch("".concat(w,"/stories?").concat(l.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 5:return h=r.sent,r.next=8,h.json();case 8:return f=r.sent,r.abrupt("return",f);case 12:return r.prev=12,r.t0=r.catch(1),r.abrupt("return",{error:!0,message:r.t0.message||"Gagal mengambil data cerita."});case 15:case"end":return r.stop()}}),r,null,[[1,12]])})))()},getStoryDetail:function(t,e){return E(x().mark((function r(){var n,o;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("".concat(w,"/stories/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 3:return n=r.sent,r.next=6,n.json();case 6:return o=r.sent,r.abrupt("return",o);case 10:return r.prev=10,r.t0=r.catch(0),r.abrupt("return",{error:!0,message:r.t0.message||"Gagal mengambil detail cerita."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},addNewStory:function(t,e){return E(x().mark((function r(){var n,o;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("".concat(w,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:e});case 3:return n=r.sent,r.next=6,n.json();case 6:return o=r.sent,r.abrupt("return",o);case 10:return r.prev=10,r.t0=r.catch(0),r.abrupt("return",{error:!0,message:r.t0.message||"Gagal menambahkan cerita baru."});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},addNewStoryAsGuest:function(t){return E(x().mark((function e(){var r,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(w,"/stories/guest"),{method:"POST",body:t});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",{error:!0,message:e.t0.message||"Gagal menambahkan cerita sebagai tamu."});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},subscribeNotification:function(t,e){return E(x().mark((function r(){var n,o;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("".concat(w,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});case 3:if((n=r.sent).ok){r.next=9;break}return r.next=7,n.json().catch((function(){return{message:"Gagal subscribe notifikasi, respons tidak valid."}}));case 7:throw o=r.sent,new Error(o.message||"HTTP error! status: ".concat(n.status));case 9:return r.abrupt("return",n.json());case 12:return r.prev=12,r.t0=r.catch(0),r.abrupt("return",{error:!0,message:r.t0.message||"Gagal subscribe notifikasi."});case 15:case"end":return r.stop()}}),r,null,[[0,12]])})))()},unsubscribeNotification:function(t,e){return E(x().mark((function r(){var n,o,i;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.endpoint,r.prev=1,r.next=4,fetch("".concat(w,"/notifications/subscribe"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({endpoint:n})});case 4:if((o=r.sent).ok){r.next=10;break}return r.next=8,o.json().catch((function(){return{message:"Gagal unsubscribe notifikasi, respons tidak valid."}}));case 8:throw i=r.sent,new Error(i.message||"HTTP error! status: ".concat(o.status));case 10:return r.abrupt("return",o.json());case 13:return r.prev=13,r.t0=r.catch(1),r.abrupt("return",{error:!0,message:r.t0.message||"Gagal unsubscribe notifikasi."});case 16:case"end":return r.stop()}}),r,null,[[1,13]])})))()}};function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function j(){j=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new M(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==P(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(P(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function O(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function C(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){O(i,n,o,a,s,"next",t)}function s(t){O(i,n,o,a,s,"throw",t)}a(void 0)}))}}var T="authToken";const M={saveToken:function(t){return C(j().mark((function e(){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem(T,t);case 1:case"end":return e.stop()}}),e)})))()},getToken:function(){return C(j().mark((function t(){return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",localStorage.getItem(T));case 1:case"end":return t.stop()}}),t)})))()},removeToken:function(){return C(j().mark((function t(){return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.removeItem(T);case 1:case"end":return t.stop()}}),t)})))()},isUserLoggedIn:function(){var t=this;return C(j().mark((function e(){var r;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getToken();case 2:return r=e.sent,e.abrupt("return",!!r);case 4:case"end":return e.stop()}}),e)})))()}};function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function N(){N=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==I(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(I(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function G(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function A(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){G(i,n,o,a,s,"next",t)}function s(t){G(i,n,o,a,s,"throw",t)}a(void 0)}))}}function F(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}const D={init:function(){return A(N().mark((function t(){var e;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator&&"PushManager"in window){t.next=3;break}return console.warn("Push Notification or Service Worker not supported by this browser."),t.abrupt("return",!1);case 3:return t.prev=3,t.next=6,navigator.serviceWorker.register("./service-worker.js");case 6:return e=t.sent,console.log("Service Worker registered successfully:",e),t.abrupt("return",e);case 11:return t.prev=11,t.t0=t.catch(3),console.error("Service Worker registration failed:",t.t0),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,null,[[3,11]])})))()},subscribeUser:function(t){var e=this;return A(N().mark((function r(){var n;return N().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t){r.next=3;break}return console.error("Service Worker registration not available for subscription."),r.abrupt("return",null);case 3:return r.prev=3,r.next=6,Notification.requestPermission();case 6:if("granted"===r.sent){r.next=10;break}throw console.warn("Notification permission not granted."),new Error("Izin notifikasi tidak diberikan.");case 10:return r.next=12,t.pushManager.getSubscription();case 12:if(!(n=r.sent)){r.next=16;break}return console.log("User IS already subscribed."),r.abrupt("return",n);case 16:return r.next=18,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:F("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk")});case 18:return n=r.sent,console.log("User subscribed successfully:",n),r.next=22,e.sendSubscriptionToServer(n);case 22:return r.abrupt("return",n);case 25:if(r.prev=25,r.t0=r.catch(3),console.error("Failed to subscribe the user: ",r.t0),"Izin notifikasi tidak diberikan."!==r.t0.message){r.next=30;break}throw r.t0;case 30:throw new Error("Gagal berlangganan notifikasi.");case 31:case"end":return r.stop()}}),r,null,[[3,25]])})))()},sendSubscriptionToServer:function(t){return A(N().mark((function e(){var r,n,o,i;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getToken();case 2:if(r=e.sent){e.next=6;break}throw console.error("Cannot send subscription to server: User not authenticated."),new Error("Pengguna tidak terautentikasi.");case 6:return n=t.toJSON(),o={endpoint:n.endpoint,keys:{p256dh:n.keys.p256dh,auth:n.keys.auth}},console.log("Sending subscription to server:",o),e.next=11,S.subscribeNotification(r,o);case 11:if(!(i=e.sent).error){e.next=15;break}throw console.error("Failed to send subscription to server:",i.message),new Error(i.message||"Gagal mengirim data langganan ke server.");case 15:console.log("Subscription sent to server successfully.");case 16:case"end":return e.stop()}}),e)})))()},unsubscribeUser:function(t){var e=this;return A(N().mark((function r(){var n,o;return N().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t){r.next=3;break}return console.error("Service Worker registration not available for unsubscription."),r.abrupt("return",!1);case 3:return r.prev=3,r.next=6,t.pushManager.getSubscription();case 6:if(!(n=r.sent)){r.next=19;break}return o=n.endpoint,r.next=11,n.unsubscribe();case 11:if(!r.sent){r.next=17;break}return console.log("User unsubscribed successfully from push service."),r.next=16,e.sendUnsubscriptionToServer(o);case 16:return r.abrupt("return",!0);case 17:r.next=21;break;case 19:return console.log("User was not subscribed."),r.abrupt("return",!0);case 21:r.next=27;break;case 23:return r.prev=23,r.t0=r.catch(3),console.error("Failed to unsubscribe user:",r.t0),r.abrupt("return",!1);case 27:return r.abrupt("return",!1);case 28:case"end":return r.stop()}}),r,null,[[3,23]])})))()},sendUnsubscriptionToServer:function(t){return A(N().mark((function e(){var r,n;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getToken();case 2:if(r=e.sent){e.next=6;break}throw console.error("Cannot send unsubscription to server: User not authenticated."),new Error("Pengguna tidak terautentikasi.");case 6:return console.log("Sending unsubscription (endpoint) to server:",t),e.next=9,S.unsubscribeNotification(r,{endpoint:t});case 9:if(!(n=e.sent).error){e.next=13;break}throw console.error("Failed to send unsubscription to server:",n.message),new Error(n.message||"Gagal mengirim data berhenti langganan ke server.");case 13:console.log("Unsubscription sent to server successfully.");case 14:case"end":return e.stop()}}),e)})))()},getCurrentSubscription:function(t){return A(N().mark((function e(){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.abrupt("return",t.pushManager.getSubscription());case 3:case"end":return e.stop()}}),e)})))()}};function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function B(){B=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==U(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(U(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function q(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function R(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){q(i,n,o,a,s,"next",t)}function s(t){q(i,n,o,a,s,"throw",t)}a(void 0)}))}}function z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H(n.key),n)}}function H(t){var e=function(t){if("object"!=U(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}const V=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new b(this,e),this._map=null,this._swRegistration=null,this._storyListContainerEl=null,this._loadingIndicatorEl=null,this._messageContainerEl=null,this._mapContainerHomeEl=null,this._mapLoadingIndicatorEl=null,this._btnSubscribePushEl=null,this._btnUnsubscribePushEl=null,this._pushNotificationStatusEl=null},e=[{key:"render",value:(a=R(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n  <section class="container home-page-content">\n    <div class="page-header-controls-wrapper">\n      <h2 class="header-page_title">Kumpulan Cerita Terbaru</h2>\n      <div class="push-notification-controls-group">\n        <button id="btn-subscribe-push" class="button button-success" style="display:none;">\n          <i class="fas fa-bell"></i> Aktifkan Notifikasi\n        </button>\n        <button id="btn-unsubscribe-push" class="button button-danger" style="display:none;">\n          <i class="fas fa-bell-slash"></i> Nonaktifkan Notifikasi\n        </button>\n        <p id="push-notification-status" style="font-size:0.8em; margin-top:5px;"></p>\n      </div>\n    </div>\n\n    <div id="message-display-home" class="message-display" style="display:none; margin-bottom: 15px;"></div>\n\n    <div id="story-list-container" class="story-list">\n    </div>\n    \n    <p id="loading-indicator" style="display:none; text-align:center; margin:20px;">Memuat cerita...</p>\n    \n    <div class="map-section" style="margin-top: 30px;">\n      <h3>Lokasi Cerita</h3>\n      <div id="map-container-home" style="height: 450px; width: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">\n         <p id="map-loading-indicator" style="text-align:center; padding-top: 20px; color:#777;">Memuat peta...</p>\n      </div>\n    </div>\n  </section>\n');case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"afterRender",value:(i=R(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._storyListContainerEl=document.querySelector("#story-list-container"),this._loadingIndicatorEl=document.querySelector("#loading-indicator"),this._messageContainerEl=document.querySelector("#message-display-home"),this._mapContainerHomeEl=document.querySelector("#map-container-home"),this._mapLoadingIndicatorEl=document.querySelector("#map-loading-indicator"),this._btnSubscribePushEl=document.querySelector("#btn-subscribe-push"),this._btnUnsubscribePushEl=document.querySelector("#btn-unsubscribe-push"),this._pushNotificationStatusEl=document.querySelector("#push-notification-status"),this._storyListContainerEl&&this._loadingIndicatorEl&&this._messageContainerEl&&this._mapContainerHomeEl&&this._mapLoadingIndicatorEl&&this._btnSubscribePushEl&&this._btnUnsubscribePushEl&&this._pushNotificationStatusEl,t.next=11,this._presenter.onViewReady();case 11:return t.next=13,this._initializePushNotificationFeature();case 13:this._setupSaveStoryButtonListeners();case 14:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"_setupSaveStoryButtonListeners",value:function(){var t=this;this._storyListContainerEl&&this._storyListContainerEl.addEventListener("click",(function(e){var r=e.target.closest(".btn-save-story");if(r&&!r.disabled){var n=r.dataset.storyId;n?t._presenter.handleSaveStoryRequest(n):t.displayMessage("ID cerita tidak ditemukan pada tombol.",!0)}}))}},{key:"renderStoryList",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if(this._storyListContainerEl)if(this.clearMessage(),this.showMainLoading(!1),t&&t.length>0){this._storyListContainerEl.innerHTML="";var r=document.createDocumentFragment();t.forEach((function(t){var n=e.has(t.id),o=document.createElement("div");o.innerHTML=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return'\n  <article class="story-item" data-story-id="'.concat(t.id,'">\n    <img src="').concat(t.photoUrl,'" alt="Foto cerita dari ').concat(t.name,": ").concat(t.description.substring(0,30),'..." class="story-item__image">\n    <div class="story-item__content">\n      <h3 class="story-item__title">').concat(t.name,'</h3>\n      <p class="story-item__date">Diposting pada: ').concat(new Date(t.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),'</p>\n      <p class="story-item__description">').concat(t.description,"</p>\n      ").concat(t.lat&&t.lon?'<p class="story-item__location">Lokasi: ('.concat(t.lat.toFixed(3),", ").concat(t.lon.toFixed(3),")</p>"):"",'\n      <div class="story-item__actions">\n        <a href="#/stories/').concat(t.id,'" class="button button-primary button-sm story-item__detail-link">Lihat Detail</a>\n        <button \n          type="button" \n          class="button button-sm btn-save-story ').concat(e?"button-success":"button-save-offline",'" \n          data-story-id="').concat(t.id,'"\n          ').concat(e?"disabled":"",'\n        >\n          <i class="fas ').concat(e?"fa-check-circle":"fa-save",'"></i> ').concat(e?"Tersimpan":"Simpan","\n        </button>\n      </div>\n    </div>\n  </article>\n")}(t,n).trim(),o.firstChild&&r.appendChild(o.firstChild)})),this._storyListContainerEl.appendChild(r)}else this.showNoStoriesMessage()}},{key:"updateSaveButtonState",value:function(t,e){if(this._storyListContainerEl){var r=this._storyListContainerEl.querySelector('.btn-save-story[data-story-id="'.concat(t,'"]'));r&&(r.disabled=e,r.innerHTML='<i class="fas '.concat(e?"fa-check-circle":"fa-save",'"></i> ').concat(e?"Tersimpan":"Simpan"),r.classList.remove("button-secondary","button-save-offline","button-success"),e?r.classList.add("button-success"):r.classList.add("button-save-offline"))}}},{key:"_initializePushNotificationFeature",value:(o=R(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window){t.next=5;break}return this._pushNotificationStatusEl&&(this._pushNotificationStatusEl.textContent="Notifikasi push tidak didukung browser ini."),this._btnSubscribePushEl&&(this._btnSubscribePushEl.style.display="none"),this._btnUnsubscribePushEl&&(this._btnUnsubscribePushEl.style.display="none"),t.abrupt("return");case 5:if(this._swRegistration){t.next=9;break}return t.next=8,D.init();case 8:this._swRegistration=t.sent;case 9:this._swRegistration?(this._updatePushSubscriptionButtonUI(),this._setupPushNotificationButtonListeners()):(this._btnSubscribePushEl&&(this._btnSubscribePushEl.style.display="none"),this._btnUnsubscribePushEl&&(this._btnUnsubscribePushEl.style.display="none"),this._pushNotificationStatusEl&&(this._pushNotificationStatusEl.textContent="Layanan notifikasi gagal diinisialisasi."));case 10:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_setupPushNotificationButtonListeners",value:function(){var t=this;this._btnSubscribePushEl&&this._btnSubscribePushEl.addEventListener("click",R(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._pushNotificationStatusEl&&(t._pushNotificationStatusEl.textContent="Memproses langganan..."),e.prev=1,e.next=4,D.subscribeUser(t._swRegistration);case 4:t._pushNotificationStatusEl&&(t._pushNotificationStatusEl.textContent="Anda telah berlangganan notifikasi!"),t._updatePushSubscriptionButtonUI(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t._pushNotificationStatusEl&&(t._pushNotificationStatusEl.textContent="Gagal berlangganan: ".concat(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))),this._btnUnsubscribePushEl&&this._btnUnsubscribePushEl.addEventListener("click",R(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._pushNotificationStatusEl&&(t._pushNotificationStatusEl.textContent="Memproses berhenti langganan..."),e.prev=1,e.next=4,D.unsubscribeUser(t._swRegistration);case 4:t._pushNotificationStatusEl&&(t._pushNotificationStatusEl.textContent="Anda telah berhenti berlangganan notifikasi."),t._updatePushSubscriptionButtonUI(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t._pushNotificationStatusEl&&(t._pushNotificationStatusEl.textContent="Gagal berhenti berlangganan: ".concat(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))))}},{key:"_updatePushSubscriptionButtonUI",value:(n=R(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._swRegistration&&this._btnSubscribePushEl&&this._btnUnsubscribePushEl){t.next=2;break}return t.abrupt("return");case 2:if("denied"!==Notification.permission){t.next=8;break}return this._pushNotificationStatusEl&&(this._pushNotificationStatusEl.textContent="Izin notifikasi diblokir."),this._btnSubscribePushEl.style.display="none",this._btnUnsubscribePushEl.style.display="none",t.abrupt("return");case 8:return t.next=10,D.getCurrentSubscription(this._swRegistration);case 10:t.sent?(this._btnSubscribePushEl.style.display="none",this._btnUnsubscribePushEl.style.display="inline-block",this._pushNotificationStatusEl&&!this._pushNotificationStatusEl.textContent.toLowerCase().includes("gagal")&&(this._pushNotificationStatusEl.textContent="Status: Berlangganan notifikasi.")):(this._btnSubscribePushEl.style.display="inline-block",this._btnUnsubscribePushEl.style.display="none",this._pushNotificationStatusEl&&!this._pushNotificationStatusEl.textContent.toLowerCase().includes("gagal")&&(this._pushNotificationStatusEl.textContent="Status: Belum berlangganan notifikasi."));case 12:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showMainLoading",value:function(t){this._loadingIndicatorEl&&(this._loadingIndicatorEl.style.display=t?"block":"none")}},{key:"displayMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this._messageContainerEl&&(this._messageContainerEl.textContent=t,this._messageContainerEl.className="message-display","error"===e?this._messageContainerEl.classList.add("error-message"):"success"===e?this._messageContainerEl.classList.add("success-message"):this._messageContainerEl.classList.add("info-message"),this._messageContainerEl.style.display="block")}},{key:"displayMainError",value:function(t){this.displayMessage(t,"error")}},{key:"displayInfoMessage",value:function(t){this.displayMessage(t,"info")}},{key:"showClearOfflineSuccessMessage",value:function(t){this.displayMessage(t,"success")}},{key:"showClearOfflineErrorMessage",value:function(t){this.displayMessage(t,"error")}},{key:"clearMessage",value:function(){this._messageContainerEl&&(this._messageContainerEl.textContent="",this._messageContainerEl.style.display="none",this._messageContainerEl.className="message-display")}},{key:"clearStoryListAndMessages",value:function(){this._storyListContainerEl&&(this._storyListContainerEl.innerHTML=""),this.clearMessage(),this._loadingIndicatorEl&&!this._storyListContainerEl.innerHTML&&(this._loadingIndicatorEl.style.display="block")}},{key:"showNoStoriesMessage",value:function(){this._storyListContainerEl&&(this._storyListContainerEl.innerHTML='<p style="text-align:center; padding: 20px;">Belum ada cerita untuk ditampilkan.</p>')}},{key:"showMapMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Memuat peta...";this._mapLoadingIndicatorEl&&(this._mapLoadingIndicatorEl.textContent=e,this._mapLoadingIndicatorEl.style.display=t?"block":"none")}},{key:"initializeMapAndMarkers",value:function(t){var e=this;if(this._mapContainerHomeEl&&"undefined"!=typeof L){this.showMapMessage(!1),this._map&&(this._map.remove(),this._map=null);var r=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OSM contributors",maxZoom:19}),n=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; ...",maxZoom:18}),o=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png",{attribution:"&copy; OSM &copy; CARTO",pane:"labels",maxZoom:19}),i={"Peta Jalan":r,"Satelit (Label)":L.layerGroup([n,o])};try{this._map=L.map(this._mapContainerHomeEl,{layers:[r]}).setView([-2.548926,118.0148634],5),this._map.getPane("labels")||(this._map.createPane("labels"),this._map.getPane("labels").style.zIndex=350,this._map.getPane("labels").style.pointerEvents="none"),L.control.layers(i,null,{position:"topright"}).addTo(this._map),t&&t.length>0?t.forEach((function(t){if(null!=t.lat&&null!=t.lon){var r=L.marker([t.lat,t.lon]).addTo(e._map),n='<div class="story-popup"><h4>'.concat(t.name,'</h4><img src="').concat(t.photoUrl,'" alt="Foto cerita oleh ').concat(t.name,'" style="width:100px; height:auto; margin-bottom:5px;"><p>').concat(t.description.substring(0,70),'...</p><a href="#/stories/').concat(t.id,'">Lihat detail</a></div>');r.bindPopup(n)}})):this._map&&L.popup().setLatLng([-2.548926,118.0148634]).setContent("Tidak ada lokasi cerita untuk ditampilkan.").openOn(this._map)}catch(t){this.showMapMessage(!0,"Terjadi kesalahan saat menampilkan peta.")}}else this.showMapMessage(!0,"Gagal memuat library atau kontainer peta.")}},{key:"navigateToLogin",value:function(){window.location.hash="#/login"}},{key:"cleanup",value:(r=R(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._map&&(this._map.remove(),this._map=null);case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&z(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function W(){W=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Y(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Y(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function K(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function J(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){K(i,n,o,a,s,"next",t)}function s(t){K(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Q(n.key),n)}}function Q(t){var e=function(t){if("object"!=Y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(e)?e:e+""}const X=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=J(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container about-page-section">\n        <div class="about-content-wrapper">\n          <h1 class="about-title">Tentang</h1>\n\n          <article class="about-section">\n            <h2>Selamat Datang!</h2>\n            <p>\n              Dicoding Story App adalah sebuah platform Single-Page Application (SPA) yang dirancang untuk memungkinkan pengguna berbagi cerita, pengalaman, atau momen berkesan mereka. Setiap cerita dapat dilengkapi dengan foto menarik dan data lokasi geografis, menjadikannya lebih hidup dan personal.\n            </p>\n            <p>\n              Proyek ini dibangun dari awal menggunakan Vanilla JavaScript, dengan fokus pada penerapan arsitektur Model-View-Presenter (MVP) dan berbagai Web API modern untuk menciptakan pengalaman pengguna yang interaktif dan responsif.\n            </p>\n          </article>\n\n          <article class="about-section">\n            <h2>Fitur Utama Aplikasi</h2>\n            <ul>\n              <li><strong>Autentikasi Pengguna:</strong> Sistem registrasi dan login yang aman untuk pengguna.</li>\n              <li><strong>Berbagi Cerita:</strong> Pengguna dapat membuat cerita baru dengan deskripsi naratif.</li>\n              <li><strong>Unggah Foto:</strong> Setiap cerita dapat disertai dengan foto yang bisa diambil langsung melalui kamera perangkat atau diunggah dari galeri.</li>\n              <li><strong>Pelabelan Lokasi (Geolocation):</strong> Pengguna dapat menandai lokasi cerita mereka dengan memilih titik di peta digital atau menggunakan lokasi mereka saat ini secara otomatis.</li>\n              <li><strong>Tampilan Cerita Interaktif:</strong> Cerita-cerita ditampilkan dalam format daftar yang menarik di halaman beranda, lengkap dengan peta yang menunjukkan semua lokasi cerita.</li>\n              <li><strong>Detail Cerita:</strong> Halaman khusus untuk melihat detail lengkap dari setiap cerita, termasuk peta lokasi spesifiknya.</li>\n              <li><strong>Single-Page Application (SPA):</strong> Navigasi antar halaman yang cepat dan mulus tanpa memuat ulang seluruh halaman, didukung oleh View Transitions API.</li>\n              <li><strong>Desain Responsif & Aksesibel:</strong> Antarmuka yang beradaptasi dengan berbagai ukuran layar dan dibangun dengan memperhatikan standar aksesibilitas web (misalnya, *skip-to-content*, teks alternatif untuk gambar, label formulir yang tepat, dan penggunaan HTML semantik).</li>\n            </ul>\n          </article>\n\n          <article class="about-section">\n            <h2>Teknologi yang Digunakan</h2>\n            <ul>\n              <li><strong>HTML5 & CSS3:</strong> Untuk struktur dan presentasi visual.</li>\n              <li><strong>Vanilla JavaScript (ES6+):</strong> Untuk semua logika aplikasi dan interaktivitas.</li>\n              <li><strong>Dicoding Story API:</strong> Sebagai backend dan sumber data utama untuk semua cerita.</li>\n              <li><strong>Webpack:</strong> Sebagai *module bundler* untuk mengelola aset dan dependensi proyek.</li>\n              <li><strong>Leaflet.js:</strong> Untuk integrasi dan tampilan peta digital.</li>\n              <li><strong>Pola Arsitektur MVP (Model-View-Presenter):</strong> Untuk memastikan kode yang terstruktur dan mudah dikelola.</li>\n              <li><strong>Web API Modern:</strong> Pemanfaatan Geolocation API, Media Devices API (untuk kamera), dan View Transitions API.</li>\n            </ul>\n          </article>\n          \n          <article class="about-section">\n            <h2>Pengembang</h2>\n            <p>\n              Aplikasi ini dikembangkan oleh <strong>Haikal Fawwaz Karim</strong> sebagai bagian dari pembelajaran dan implementasi materi di Dicoding.\n            </p>\n            <p>\n              Terima kasih telah mengunjungi dan menggunakan Dicoding Story App!\n            </p>\n          </article>\n\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=J(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log('AboutPage afterRender: Halaman "Tentang Kami" telah dirender.');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&Z(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function tt(){tt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==$(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError($(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function et(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function rt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){et(i,n,o,a,s,"next",t)}function s(t){et(i,n,o,a,s,"throw",t)}a(void 0)}))}}function nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ot(n.key),n)}}function ot(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}const it=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._authAPI=r.authAPI,this._authService=r.authService},e=[{key:"onViewReady",value:(n=rt(tt().mark((function t(){return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._authService.isUserLoggedIn();case 2:if(!t.sent){t.next=4;break}this._view.navigateToHome();case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"handleLoginAttempt",value:(r=rt(tt().mark((function t(e,r){var n,o=this;return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._view.clearMessage(),e&&r){t.next=4;break}return this._view.displayMessage("Email dan password tidak boleh kosong.",!0),t.abrupt("return");case 4:return this._view.setSubmitButtonDisabled(!0),this._view.showLoginLoading(!0),this._view.displayMessage("Mencoba untuk login...",!1,!0),t.prev=7,t.next=10,this._authAPI.login({email:e,password:r});case 10:if(!(n=t.sent).error){t.next=15;break}this._view.displayMessage(n.message||"Login gagal. Periksa kembali email dan password Anda.",!0),t.next=23;break;case 15:if(!n.loginResult||!n.loginResult.token){t.next=22;break}return t.next=18,this._authService.saveToken(n.loginResult.token);case 18:this._view.displayMessage("Login berhasil! Mengarahkan ke beranda...",!1),setTimeout((function(){o._view.navigateToHome()}),1e3),t.next=23;break;case 22:this._view.displayMessage("Gagal login, respons dari server tidak sesuai format.",!0);case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(7),this._view.displayMessage(t.t0.message||"Terjadi kesalahan fatal saat mencoba login.",!0);case 28:return t.prev=28,this._view.showLoginLoading(!1),this._view.setSubmitButtonDisabled(!1),t.finish(28);case 32:case"end":return t.stop()}}),t,this,[[7,25,28,32]])}))),function(t,e){return r.apply(this,arguments)})}],e&&nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function st(){st=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==at(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(at(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ut(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ct(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ut(i,n,o,a,s,"next",t)}function s(t){ut(i,n,o,a,s,"throw",t)}a(void 0)}))}}function lt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ht(n.key),n)}}function ht(t){var e=function(t){if("object"!=at(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=at(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==at(e)?e:e+""}const ft=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new it(this,e),this._loginFormElement=null,this._emailInputElement=null,this._passwordInputElement=null,this._messageContainer=null,this._submitButton=null,this._loadingSpinnerElement=null},e=[{key:"render",value:(o=ct(st().mark((function t(){return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n  <div class="auth-page-container">\n    <section class="login-page">\n      <h2>Login Pengguna</h2>\n      <form id="login-form">\n        <div class="form-group">\n          <label for="email-input">Email:</label>\n          <input type="email" id="email-input" name="email" required>\n        </div>\n        \n        <div class="form-group">\n          <label for="password-input">Password:</label>\n          <input type="password" id="password-input" name="password" required minlength="8">\n        </div>\n\n        <div id="login-loading-spinner" style="display:none; text-align:center; margin: 15px 0;">\n          <div class="spinner"></div>\n        </div>\n\n        <div id="message-display-login" class="message-display" style="display:none;"></div> \n        \n        <button type="submit" class="button button-primary">Login</button>\n      </form>\n      <p class="auth-switch">Belum punya akun? <a href="#/register">Registrasi di sini</a></p>\n    </section>\n  </div>\n');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=ct(st().mark((function t(){var e=this;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._loginFormElement=document.querySelector("#login-form"),this._emailInputElement=document.querySelector("#email-input"),this._passwordInputElement=document.querySelector("#password-input"),this._messageContainer=document.querySelector("#message-display-login"),this._loadingSpinnerElement=document.querySelector("#login-loading-spinner"),this._loginFormElement?(this._submitButton=this._loginFormElement.querySelector('button[type="submit"]'),this._loginFormElement.addEventListener("submit",function(){var t=ct(st().mark((function t(r){var n,o;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),n=e._emailInputElement?e._emailInputElement.value:"",o=e._passwordInputElement?e._passwordInputElement.value:"",t.next=5,e._presenter.handleLoginAttempt(n,o);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())):console.error("VIEW (LoginPage): Login form element (#login-form) not found."),this._presenter&&"function"==typeof this._presenter.onViewReady){t.next=11;break}console.error("VIEW (LoginPage): CRITICAL - Presenter or onViewReady method is not available!"),this._messageContainer&&this.displayMessage("Kesalahan internal aplikasi saat inisialisasi.",!0),t.next=13;break;case 11:return t.next=13,this._presenter.onViewReady();case 13:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showLoginLoading",value:function(t){this._loadingSpinnerElement&&(this._loadingSpinnerElement.style.display=t?"block":"none")}},{key:"displayMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._messageContainer){this._messageContainer.textContent=t;var n="message-display";e?n+=" error-message":r||(n+=" success-message"),this._messageContainer.className=n,this._messageContainer.style.display=t?"block":"none"}}},{key:"clearMessage",value:function(){this._messageContainer&&(this._messageContainer.textContent="",this._messageContainer.style.display="none",this._messageContainer.className="message-display")}},{key:"setSubmitButtonDisabled",value:function(t){this._submitButton&&(this._submitButton.disabled=t)}},{key:"navigateToHome",value:function(){window.location.hash="#/"}},{key:"navigateToLogin",value:function(){window.location.hash="#/login"}},{key:"cleanup",value:(r=ct(st().mark((function t(){return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&lt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function yt(){yt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==pt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(pt(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function dt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function vt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){dt(i,n,o,a,s,"next",t)}function s(t){dt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gt(n.key),n)}}function gt(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}const bt=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._authAPI=r.authAPI,this._authService=r.authService},e=[{key:"onViewReady",value:(n=vt(yt().mark((function t(){return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._authService.isUserLoggedIn();case 2:if(!t.sent){t.next=4;break}this._view.navigateToHome();case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"handleRegisterAttempt",value:(r=vt(yt().mark((function t(e,r,n){var o,i=this;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._view.clearMessage(),e&&r&&n){t.next=4;break}return this._view.displayMessage("Semua field tidak boleh kosong.",!0),t.abrupt("return");case 4:if(!(n.length<8)){t.next=7;break}return this._view.displayMessage("Password minimal harus 8 karakter.",!0),t.abrupt("return");case 7:return this._view.setSubmitButtonDisabled(!0),this._view.showRegisterLoading(!0),this._view.displayMessage("Mencoba mendaftarkan akun...",!1,!0),t.prev=10,t.next=13,this._authAPI.register({name:e,email:r,password:n});case 13:(o=t.sent).error?this._view.displayMessage(o.message||"Registrasi gagal. Silakan coba lagi.",!0):(this._view.displayMessage(o.message||"Registrasi berhasil! Anda akan diarahkan ke halaman login.",!1),setTimeout((function(){i._view.navigateToLogin()}),2500)),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(10),this._view.displayMessage(t.t0.message||"Terjadi kesalahan fatal saat mencoba registrasi.",!0);case 20:return t.prev=20,this._view.showRegisterLoading(!1),this._view.setSubmitButtonDisabled(!1),t.finish(20);case 24:case"end":return t.stop()}}),t,this,[[10,17,20,24]])}))),function(t,e,n){return r.apply(this,arguments)})}],e&&mt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function _t(){_t=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==wt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(wt(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function xt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function kt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){xt(i,n,o,a,s,"next",t)}function s(t){xt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Lt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Et(n.key),n)}}function Et(t){var e=function(t){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wt(e)?e:e+""}const St=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new bt(this,e),this._registerFormElement=null,this._nameInputElement=null,this._emailInputElement=null,this._passwordInputElement=null,this._messageContainer=null,this._submitButton=null},e=[{key:"render",value:(o=kt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n  <div class="auth-page-container">\n    <section class="register-page">\n      <h2>Registrasi Akun Baru</h2>\n      <form id="register-form">\n        <div class="form-group">\n          <label for="name-input-register">Nama:</label>\n          <input type="text" id="name-input-register" name="name" required>\n        </div>\n        <div class="form-group">\n          <label for="email-input-register">Email:</label>\n          <input type="email" id="email-input-register" name="email" required>\n        </div>\n        <div class="form-group">\n          <label for="password-input-register">Password:</label>\n          <input type="password" id="password-input-register" name="password" required minlength="8">\n        </div>\n        \n        <div id="register-loading-spinner" style="display:none; text-align:center; margin: 15px 0;">\n          <div class="spinner"></div>\n        </div>\n\n        <div id="message-container-register" class="message-display" style="display:none;"></div> \n        \n        <button type="submit" class="button button-primary">Registrasi</button>\n      </form>\n      <p class="auth-switch">Sudah punya akun? <a href="#/login">Login di sini</a></p>\n    </section>\n  </div>\n');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=kt(_t().mark((function t(){var e=this;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._registerFormElement=document.querySelector("#register-form"),this._nameInputElement=document.querySelector("#name-input-register"),this._emailInputElement=document.querySelector("#email-input-register"),this._passwordInputElement=document.querySelector("#password-input-register"),this._messageContainer=document.querySelector("#message-container-register"),this._loadingSpinnerElement=document.querySelector("#register-loading-spinner"),this._registerFormElement?(this._submitButton=this._registerFormElement.querySelector('button[type="submit"]'),this._registerFormElement.addEventListener("submit",function(){var t=kt(_t().mark((function t(r){var n,o,i;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=e._nameInputElement?e._nameInputElement.value:"",o=e._emailInputElement?e._emailInputElement.value:"",i=e._passwordInputElement?e._passwordInputElement.value:"",e._presenter&&"function"==typeof e._presenter.handleRegisterAttempt){t.next=7;break}return e.displayMessage("Kesalahan internal aplikasi.",!0),t.abrupt("return");case 7:return t.next=9,e._presenter.handleRegisterAttempt(n,o,i);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())):console.error("VIEW (RegisterPage): Register form element (#register-form) not found."),this._presenter&&"function"==typeof this._presenter.onViewReady){t.next=11;break}this.displayMessage("Kesalahan internal aplikasi saat inisialisasi.",!0),t.next=13;break;case 11:return t.next=13,this._presenter.onViewReady();case 13:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showRegisterLoading",value:function(t){this._loadingSpinnerElement&&(this._loadingSpinnerElement.style.display=t?"block":"none")}},{key:"displayMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._messageContainer){this._messageContainer.textContent=t;var n="message-display";e?n+=" error-message":r||(n+=" success-message"),this._messageContainer.className=n,this._messageContainer.style.display=t?"block":"none"}}},{key:"clearMessage",value:function(){this._messageContainer&&(this._messageContainer.textContent="",this._messageContainer.style.display="none",this._messageContainer.className="message-display")}},{key:"setSubmitButtonDisabled",value:function(t){this._submitButton&&(this._submitButton.disabled=t)}},{key:"navigateToLogin",value:function(){window.location.hash="#/login"}},{key:"navigateToHome",value:function(){window.location.hash="#/"}},{key:"cleanup",value:(r=kt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&Lt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function jt(){jt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Pt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Pt(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Ot(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ct(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ot(i,n,o,a,s,"next",t)}function s(t){Ot(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mt(n.key),n)}}function Mt(t){var e=function(t){if("object"!=Pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pt(e)?e:e+""}const It=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._authAPI=r.authAPI,this._authService=r.authService,this._story=null},e=[{key:"onViewReady",value:(n=Ct(jt().mark((function t(e){return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._authService.isUserLoggedIn();case 2:if(t.sent){t.next=5;break}return this._view.navigateToLogin(),t.abrupt("return");case 5:if(e){t.next=9;break}return this._view.showLoading(!1),this._view.displayError("ID Cerita tidak valid atau tidak ditemukan di URL."),t.abrupt("return");case 9:return t.next=11,this._loadStoryDetail(e);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_loadStoryDetail",value:(r=Ct(jt().mark((function t(e){var r,n,o,i;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(!0),this._view.clearContentAndMessages(),r=!1,t.prev=3,t.next=6,u(e);case 6:(n=t.sent)&&(this._story=n,this._view.renderStoryToDOM(this._story),null!=this._story.lat&&null!=this._story.lon?this._view.initializeAndShowMap(this._story):this._view.hideMapDisplay(),this._view.showLoading(!1),this._view.displayInfoMessage("Menampilkan data offline. Mencoba mengambil versi terbaru..."),r=!0),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),console.error("DetailPagePresenter: Error fetching story from IndexedDB:",t.t0);case 13:return t.prev=13,t.next=16,this._authService.getToken();case 16:return o=t.sent,t.next=19,this._authAPI.getStoryDetail(o,e);case 19:if(!(i=t.sent).error){t.next=24;break}r?this._view.displayInfoMessage("Gagal mengambil versi terbaru. Menampilkan data offline."):this._view.displayError(i.message||"Gagal memuat detail cerita."),t.next=34;break;case 24:if(!i.story){t.next=33;break}return this._story=i.story,t.next=28,a(this._story);case 28:this._view.clearMessage(),this._view.renderStoryToDOM(this._story),null!=this._story.lat&&null!=this._story.lon?this._view.initializeAndShowMap(this._story):this._view.hideMapDisplay(),t.next=34;break;case 33:r||this._view.displayError("Data detail cerita tidak ditemukan dari server.");case 34:t.next=40;break;case 36:t.prev=36,t.t1=t.catch(13),console.error("DetailPagePresenter: Exception while fetching story detail from network:",t.t1),r?this._view.displayInfoMessage("Gagal terhubung ke jaringan. Menampilkan data offline."):this._view.displayError(t.t1.message||"Terjadi kesalahan saat mengambil data detail cerita.");case 40:return t.prev=40,this._view.showLoading(!1),t.finish(40);case 43:case"end":return t.stop()}}),t,this,[[3,10],[13,36,40,43]])}))),function(t){return r.apply(this,arguments)})}],e&&Tt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Nt(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function Gt(){return location.hash.replace("#","")||"/"}function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Ft(){Ft=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==At(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(At(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Dt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ut(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Dt(i,n,o,a,s,"next",t)}function s(t){Dt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qt(n.key),n)}}function qt(t){var e=function(t){if("object"!=At(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==At(e)?e:e+""}const Rt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new It(this,e),this._map=null,this._loadingIndicatorEl=null,this._messageContainerEl=null,this._storyContentContainerEl=null,this._mapContainerEl=null},e=[{key:"render",value:(o=Ut(Ft().mark((function t(){return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n  <section class="container detail-page-container">\n    <p id="detail-loading-indicator" style="text-align:center;">Memuat detail cerita...</p>\n    <div id="message-display-detail" class="message-display" style="display:none; margin-bottom: 15px;"></div>\n    <div id="story-detail-content-container">\n    </div>\n  </section>\n');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=Ut(Ft().mark((function t(){var e,r,n;return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._loadingIndicatorEl=document.querySelector("#detail-loading-indicator"),this._messageContainerEl=document.querySelector("#message-display-detail"),this._storyContentContainerEl=document.querySelector("#story-detail-content-container"),this._loadingIndicatorEl&&this._messageContainerEl&&this._storyContentContainerEl){t.next=8;break}return(e=document.querySelector("#main-content"))&&(e.innerHTML="<p>Error: Gagal memuat komponen UI halaman detail.</p>"),console.error("DetailPage afterRender: One or more critical UI shell elements not found after rendering DetailPageTemplate!"),t.abrupt("return");case 8:return r=Nt(Gt()),n=r.id,t.next=12,this._presenter.onViewReady(n);case 12:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showLoading",value:function(t){this._loadingIndicatorEl&&(this._loadingIndicatorEl.style.display=t?"block":"none")}},{key:"clearContentAndMessages",value:function(){this._storyContentContainerEl&&(this._storyContentContainerEl.innerHTML=""),this._messageContainerEl&&(this._messageContainerEl.style.display="none"),this._loadingIndicatorEl&&!this._storyContentContainerEl.innerHTML&&(this._loadingIndicatorEl.style.display="block")}},{key:"displayMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this._messageContainerEl&&(this._messageContainerEl.textContent=t,this._messageContainerEl.className="message-display","error"===e?this._messageContainerEl.classList.add("error-message"):"success"===e?this._messageContainerEl.classList.add("success-message"):this._messageContainerEl.classList.add("info-message"),this._messageContainerEl.style.display="block")}},{key:"displayError",value:function(t){this.displayMessage(t,"error")}},{key:"displayInfoMessage",value:function(t){this.displayMessage(t,"info")}},{key:"clearMessage",value:function(){this._messageContainerEl&&(this._messageContainerEl.textContent="",this._messageContainerEl.style.display="none",this._messageContainerEl.className="message-display")}},{key:"renderStoryToDOM",value:function(t){this._storyContentContainerEl&&(this._storyContentContainerEl.innerHTML=function(t){return t?'\n    <article class="story-detail">\n      <h2 class="story-detail__title">Cerita oleh: '.concat(t.name,'</h2>\n      <img src="').concat(t.photoUrl,'" alt="Foto detail cerita oleh ').concat(t.name,": ").concat(t.description.substring(0,50),'..." class="story-detail__image">\n      <div class="story-detail__meta">\n        <p>Diposting pada: \n          <time datetime="').concat(t.createdAt,'">\n            ').concat(new Date(t.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),"\n          </time>\n        </p>\n        ").concat(t.lat&&t.lon?"<p>Lokasi: (".concat(t.lat.toFixed(3),", ").concat(t.lon.toFixed(3),")</p>"):"",'\n      </div>\n      <div class="story-detail__description">\n        <h3>Deskripsi:</h3>\n        <p>').concat(t.description.replace(/\n/g,"<br>"),'</p>\n      </div>\n      <div id="map-container-detail" style="height: 300px; margin-top: 20px; display: ').concat(t.lat&&t.lon?"block":"none",'; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">\n      </div>\n      <a href="#/" class="button button-secondary" style="margin-top: 20px;">Kembali ke Beranda</a>\n    </article>\n  '):"<p>Data cerita tidak tersedia.</p>"}(t),this._mapContainerEl=this._storyContentContainerEl.querySelector("#map-container-detail"))}},{key:"initializeAndShowMap",value:function(t){if(this._mapContainerEl&&"undefined"!=typeof L)if(t&&null!=t.lat&&null!=t.lon){this._mapContainerEl.innerHTML="",this._mapContainerEl.style.display="block",this._map&&(this._map.remove(),this._map=null);try{this._map=L.map(this._mapContainerEl,{layers:[L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:19})]}).setView([t.lat,t.lon],15);var e=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; ...",maxZoom:18}),r=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png",{attribution:"&copy; OSM &copy; CARTO",pane:"labels",maxZoom:19}),n=L.layerGroup([e,r]),o={"Peta Jalan":this._map.hasLayer(e)?null:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),"Satelit (Label)":n};this._map.getPane("labels")||(this._map.createPane("labels"),this._map.getPane("labels").style.zIndex=350,this._map.getPane("labels").style.pointerEvents="none"),L.control.layers(o,null,{position:"topright"}).addTo(this._map),L.marker([t.lat,t.lon]).addTo(this._map).bindPopup("<b>".concat(t.name,"</b><br>Lokasi cerita ini."))}catch(t){this._mapContainerEl&&(this._mapContainerEl.innerHTML="<p>Terjadi kesalahan saat menampilkan peta lokasi.</p>")}}else this.hideMapDisplay();else this._mapContainerEl&&(this._mapContainerEl.innerHTML="<p>Gagal memuat library peta.</p>")}},{key:"hideMapDisplay",value:function(){this._mapContainerEl||(this._mapContainerEl=document.querySelector("#map-container-detail")),this._mapContainerEl&&(this._mapContainerEl.style.display="none")}},{key:"navigateToLogin",value:function(){window.location.hash="#/login"}},{key:"cleanup",value:(r=Ut(Ft().mark((function t(){return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._map&&(this._map.remove(),this._map=null);case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&Bt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Ht(){Ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==zt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(zt(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Vt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Yt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Vt(i,n,o,a,s,"next",t)}function s(t){Vt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kt(n.key),n)}}function Kt(t){var e=function(t){if("object"!=zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:e+""}const Jt=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._authAPI=r.authAPI,this._authService=r.authService,this._currentPhotoFile=null,this._currentLatitude=null,this._currentLongitude=null},e=[{key:"onViewReady",value:(o=Yt(Ht().mark((function t(){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._authService.isUserLoggedIn();case 2:if(t.sent){t.next=6;break}return this._view.navigateToLogin(),t.abrupt("return");case 6:this._view.initializeMapForAdding();case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"handleSubmitStory",value:(n=Yt(Ht().mark((function t(e,r,n,o){var i,a,s,u=this;return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._view.clearMessage(),e.trim()){t.next=4;break}return this._view.displayMessage("Deskripsi cerita tidak boleh kosong.",!0),t.abrupt("return");case 4:if(r){t.next=7;break}return this._view.displayMessage("Foto cerita harus diambil atau diunggah.",!0),t.abrupt("return");case 7:if(!(r.size>1e6)){t.next=11;break}return this._view.displayMessage("Ukuran foto terlalu besar (".concat((r.size/1e6).toFixed(2)," MB). Maksimum 1MB."),!0),t.abrupt("return");case 11:return this._view.displayMessage("Mengunggah cerita...",!1,!0),this._view.setSubmitButtonDisabled(!0),(i=new FormData).append("description",e),i.append("photo",r),null!==n&&null!==o&&(i.append("lat",parseFloat(n)),i.append("lon",parseFloat(o))),t.prev=17,t.next=20,this._authService.getToken();case 20:return a=t.sent,t.next=23,this._authAPI.addNewStory(a,i);case 23:(s=t.sent).error?this._view.displayMessage(s.message||"Gagal menambahkan cerita.",!0):(this._view.displayMessage("Cerita berhasil ditambahkan! Anda akan diarahkan ke beranda.",!1),this._view.resetFormAndInternalState(),this._currentPhotoFile=null,this._currentLatitude=null,this._currentLongitude=null,setTimeout((function(){u._view.navigateToHome()}),2500)),t.next=30;break;case 27:t.prev=27,t.t0=t.catch(17),this._view.displayMessage(t.t0.message||"Terjadi kesalahan saat menambahkan cerita.",!0);case 30:return t.prev=30,this._view.setSubmitButtonDisabled(!1),t.finish(30);case 33:case"end":return t.stop()}}),t,this,[[17,27,30,33]])}))),function(t,e,r,o){return n.apply(this,arguments)})},{key:"handleGetCurrentLocationRequest",value:(r=Yt(Ht().mark((function t(){var e;return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.clearMessage(),this._view.displayMessage("Mencari lokasi Anda saat ini...",!1,!0),t.prev=2,t.next=5,this._view.fetchCurrentGeolocationFromPlatform();case 5:e=t.sent,this._currentLatitude=e.latitude,this._currentLongitude=e.longitude,this._view.updateLocationInputsUI(this._currentLatitude,this._currentLongitude),this._view.setMapView(this._currentLatitude,this._currentLongitude,15),this._view.updateMapMarkerAndPopup(this._currentLatitude,this._currentLongitude,"Lokasi Anda saat ini"),this._view.displayMessage("Lokasi saat ini berhasil didapatkan.",!1),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),this._view.displayMessage(t.t0.message,!0);case 17:case"end":return t.stop()}}),t,this,[[2,14]])}))),function(){return r.apply(this,arguments)})},{key:"handleMapClick",value:function(t,e){this._currentLatitude=t,this._currentLongitude=e,this._view.updateLocationInputsUI(t,e),this._view.updateMapMarkerAndPopup(t,e,"Lokasi cerita dipilih")}},{key:"handleStartCameraRequest",value:function(){this._currentPhotoFile=null,this._view.activateCamera()}},{key:"handleCapturePhotoRequest",value:function(){this._view.triggerPhotoCapture()}},{key:"handlePhotoSelectedOrCaptured",value:function(t){this._currentPhotoFile=t,this._view.showPhotoPreviewUI(t),this._view.stopCameraStreamIfActive()}},{key:"handleToggleMapSizeRequest",value:function(){var t=this._view.toggleMapExpansionUI();this._view.updateToggleMapButtonTextUI(t)}},{key:"handleCleanupRequest",value:function(){this._view.stopCameraStreamIfActive(),this._view.getMapExpansionState()&&(this._view.collapseMapUI(),this._view.updateToggleMapButtonTextUI(!1))}}],e&&Wt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function Zt(t){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(t)}function Qt(){Qt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==Zt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Zt(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Xt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function $t(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Xt(i,n,o,a,s,"next",t)}function s(t){Xt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ee(n.key),n)}}function ee(t){var e=function(t){if("object"!=Zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zt(e)?e:e+""}const re=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new Jt(this,e),this._photoFileInternal=null,this._latitudeInternal=null,this._longitudeInternal=null,this._videoStream=null,this._map=null,this._mapMarker=null,this._isMapExpanded=!1,this._elements={},this._boundCleanup=this.cleanup.bind(this)},e=[{key:"render",value:(a=$t(Qt().mark((function t(){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n  <div class="auth-page-container">\n    <section class="add-story-page">\n      <h2>Tambah Cerita Baru</h2>\n      <form id="add-story-form" enctype="multipart/form-data">\n        <div class="form-group">\n          <label for="description-input">Deskripsi Cerita:</label>\n          <textarea id="description-input" name="description" rows="4" required></textarea>\n        </div>\n\n        <div class="form-group">\n          <label>Foto Cerita:</label>\n          <button type="button" id="start-camera-button" class="button-secondary">Gunakan Kamera</button>\n          <video id="camera-video" style="display:none; width:100%; max-width:400px; margin-top:10px; border:1px solid #ccc;" playsinline autoplay muted></video>\n          <button type="button" id="capture-photo-button" style="display:none; margin-top:10px;" class="button-primary">Ambil Foto</button>\n          <img id="photo-preview" src="#" alt="Preview foto cerita" style="display:none; max-width:100%; max-height:300px; margin-top:10px; border:1px solid #ccc;">\n          <p style="font-size: 0.8em; margin-top: 15px; margin-bottom: 5px;">Atau unggah file manual:</p>\n          <input type="file" id="photo-input" name="photo" accept="image/*">\n          <p style="font-size: 0.75em; color: #666; margin-top: 5px;">Maksimum ukuran file: 1MB</p>\n        </div>\n\n        <div class="form-group">\n          <label>Pilih Lokasi Cerita:</label>\n          <p style="font-size: 0.8em; margin-bottom: 5px;">Klik di peta untuk memilih lokasi, atau gunakan lokasi Anda saat ini.</p>\n          \n          <div id="map-ui-wrapper" style="position: relative;">\n            \n            <div id="map-container-add" style="height: 300px; width: 100%; border:1px solid #ccc; background-color: #f0f0f0; margin-bottom: 10px;">\n            </div>\n\n            <button type="button" id="toggle-map-size-button" class="button-map-toggle">\n              Perbesar Peta\n            </button>\n\n          </div>\n\n          <div style="display:flex; gap:10px; margin-top:10px; margin-bottom: 15px;">\n            <div style="flex:1;">\n              <label for="latitude-input" style="font-size:0.8em">Latitude:</label>\n              <input type="text" id="latitude-input" name="latitude" readonly style="background:#f0f0f0; font-size:0.9em;">\n            </div>\n            <div style="flex:1;">\n              <label for="longitude-input" style="font-size:0.8em">Longitude:</label>\n              <input type="text" id="longitude-input" name="longitude" readonly style="background:#f0f0f0; font-size:0.9em;">\n            </div>\n          </div>\n\n          <button type="button" id="get-current-location-button" class="button-location" style="display: block; width:auto; margin: 0 auto;">\n            Pilih Lokasi Saya Saat Ini\n          </button>\n        </div>\n        <div id="message-container-add" style="display:none; margin-bottom:15px;"></div>\n        <div class="form-actions">\n          <a href="#/" class="button-secondary button-back">Kembali ke Beranda</a>\n          <button type="submit" class="button-primary">Publikasikan Cerita</button>\n        </div>\n      </form>\n    </section>\n  </div>\n');case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"afterRender",value:(i=$t(Qt().mark((function t(){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._elements=this._getElements(),this._elements.form){t.next=3;break}return t.abrupt("return");case 3:return this._setupEventListeners(),t.next=6,this._presenter.onViewReady();case 6:window.addEventListener("hashchange",this._boundCleanup,{once:!0});case 7:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"_getElements",value:function(){return{form:document.querySelector("#add-story-form"),descriptionInput:document.querySelector("#description-input"),photoInput:document.querySelector("#photo-input"),startCameraButton:document.querySelector("#start-camera-button"),cameraVideo:document.querySelector("#camera-video"),capturePhotoButton:document.querySelector("#capture-photo-button"),photoPreview:document.querySelector("#photo-preview"),mapUiWrapper:document.querySelector("#map-ui-wrapper"),mapContainer:document.querySelector("#map-container-add"),toggleMapSizeButton:document.querySelector("#toggle-map-size-button"),latitudeInput:document.querySelector("#latitude-input"),longitudeInput:document.querySelector("#longitude-input"),getCurrentLocationButton:document.querySelector("#get-current-location-button"),messageContainer:document.querySelector("#message-container-add")}}},{key:"_setupEventListeners",value:function(){var t=this;this._elements.form.addEventListener("submit",(function(e){e.preventDefault();var r=t._elements.descriptionInput.value;t._presenter.handleSubmitStory(r,t._photoFileInternal,t._latitudeInternal,t._longitudeInternal)})),this._elements.startCameraButton.addEventListener("click",(function(){return t._presenter.handleStartCameraRequest()})),this._elements.capturePhotoButton.addEventListener("click",(function(){return t._presenter.handleCapturePhotoRequest()})),this._elements.photoInput.addEventListener("change",(function(e){var r=e.target.files?e.target.files[0]:null;r?t._presenter.handlePhotoSelectedOrCaptured(r):t._resetPhotoUIAndInternalState()})),this._elements.getCurrentLocationButton.addEventListener("click",(function(){return t._presenter.handleGetCurrentLocationRequest()})),this._elements.toggleMapSizeButton.addEventListener("click",(function(){return t._presenter.handleToggleMapSizeRequest()}))}},{key:"displayMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._elements.messageContainer){this._elements.messageContainer.textContent=t;var n="message-display";e?n+=" error-message":r||(n+=" success-message"),this._elements.messageContainer.className=n,this._elements.messageContainer.style.display="block"}}},{key:"clearMessage",value:function(){this._elements.messageContainer&&(this._elements.messageContainer.textContent="",this._elements.messageContainer.style.display="none",this._elements.messageContainer.className="message-display")}},{key:"setSubmitButtonDisabled",value:function(t){var e=this._elements.form.querySelector('button[type="submit"]');e&&(e.disabled=t)}},{key:"updateLocationInputsUI",value:function(t,e){this._latitudeInternal=t,this._longitudeInternal=e,this._elements.latitudeInput&&(this._elements.latitudeInput.value=null!==t?t.toFixed(5):""),this._elements.longitudeInput&&(this._elements.longitudeInput.value=null!==e?e.toFixed(5):"")}},{key:"setMapView",value:function(t,e,r){this._map&&this._map.setView([t,e],r)}},{key:"updateMapMarkerAndPopup",value:function(t,e,r){this._map&&(this._mapMarker?this._mapMarker.setLatLng([t,e]):this._mapMarker=L.marker([t,e]).addTo(this._map),this._mapMarker.bindPopup(r).openPopup())}},{key:"showPhotoPreviewUI",value:function(t){var e=this;this._photoFileInternal=t;var r=new FileReader;r.onload=function(t){e._elements.photoPreview&&(e._elements.photoPreview.src=t.target.result,e._elements.photoPreview.style.display="block"),e._elements.cameraVideo&&(e._elements.cameraVideo.style.display="none"),e._elements.capturePhotoButton&&(e._elements.capturePhotoButton.textContent="Ambil Ulang Foto"),e._elements.startCameraButton&&(e._elements.startCameraButton.textContent="Ganti Foto (Kamera)")},r.onerror=function(){e.displayMessage("Gagal menampilkan preview foto.",!0)},r.readAsDataURL(t)}},{key:"_resetPhotoUIAndInternalState",value:function(){this._photoFileInternal=null,this._elements.photoInput&&(this._elements.photoInput.value=""),this._elements.photoPreview&&(this._elements.photoPreview.src="#",this._elements.photoPreview.style.display="none"),this._elements.cameraVideo&&(this._elements.cameraVideo.style.display="none"),this._elements.capturePhotoButton&&(this._elements.capturePhotoButton.textContent="Ambil Foto",this._elements.capturePhotoButton.style.display="none"),this._elements.startCameraButton&&(this._elements.startCameraButton.textContent="Gunakan Kamera"),this.stopCameraStreamIfActive()}},{key:"resetFormAndInternalState",value:function(){this._resetPhotoUIAndInternalState(),this._elements.descriptionInput&&(this._elements.descriptionInput.value=""),this.updateLocationInputsUI(null,null),this._mapMarker&&this._map&&(this._map.removeLayer(this._mapMarker),this._mapMarker=null),this._map&&this._map.setView([-6.2088,106.8456],10)}},{key:"navigateToHome",value:function(){window.location.hash="#/"}},{key:"navigateToLogin",value:function(){window.location.hash="#/login"}},{key:"activateCamera",value:(o=$t(Qt().mark((function t(){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._resetPhotoUIAndInternalState(),this._elements.cameraVideo&&this._elements.capturePhotoButton&&this._elements.startCameraButton){t.next=3;break}return t.abrupt("return");case 3:if(this._elements.cameraVideo.style.display="block",this._elements.capturePhotoButton.style.display="block",!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){t.next=23;break}return t.prev=6,t.next=9,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 9:this._videoStream=t.sent,this._elements.cameraVideo.srcObject=this._videoStream,this._elements.startCameraButton.textContent="Kamera Aktif",t.next=21;break;case 14:t.prev=14,t.t0=t.catch(6),this._videoStream=null,this.displayMessage("Kamera tidak bisa diakses. Pastikan izin telah diberikan.",!0),this._elements.cameraVideo.style.display="none",this._elements.capturePhotoButton.style.display="none",this._elements.startCameraButton.textContent="Coba Lagi Kamera";case 21:t.next=24;break;case 23:this.displayMessage("Fitur kamera tidak didukung browser ini.",!0);case 24:case"end":return t.stop()}}),t,this,[[6,14]])}))),function(){return o.apply(this,arguments)})},{key:"triggerPhotoCapture",value:function(){var t=this;if(this._videoStream){var e=document.createElement("canvas");e.width=this._elements.cameraVideo.videoWidth,e.height=this._elements.cameraVideo.videoHeight,e.getContext("2d").drawImage(this._elements.cameraVideo,0,0,e.width,e.height),e.toBlob((function(e){var r=new File([e],"story-".concat(Date.now(),".jpg"),{type:"image/jpeg"});t._presenter.handlePhotoSelectedOrCaptured(r)}),"image/jpeg",.9)}else this.displayMessage("Kamera belum aktif untuk mengambil foto.",!0)}},{key:"stopCameraStreamIfActive",value:function(){this._videoStream&&(this._videoStream.getTracks().forEach((function(t){return t.stop()})),this._videoStream=null,this._elements.cameraVideo&&(this._elements.cameraVideo.srcObject=null),this._elements.startCameraButton&&(this._elements.startCameraButton.textContent="Gunakan Kamera"))}},{key:"fetchCurrentGeolocationFromPlatform",value:(n=$t(Qt().mark((function t(){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){return t(e.coords)}),(function(t){var r="Gagal mendapatkan lokasi: ";switch(t.code){case t.PERMISSION_DENIED:r+="Anda menolak izin lokasi.";break;case t.POSITION_UNAVAILABLE:r+="Info lokasi tidak tersedia.";break;case t.TIMEOUT:r+="Permintaan lokasi timeout.";break;default:r+="Kesalahan tidak diketahui."}e(new Error(r))}),{enableHighAccuracy:!0,timeout:15e3,maximumAge:0}):e(new Error("Geolocation tidak didukung browser ini."))})));case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"initializeMapForAdding",value:function(){var t=this;if(this._elements.mapContainer&&"undefined"!=typeof L){this._elements.mapContainer.innerHTML="";var e=[-6.2088,106.8456];this._map&&(this._map.remove(),this._map=null);var r=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}),n=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",maxZoom:18}),o=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',pane:"labels",maxZoom:19}),i={"Peta Jalan":r,"Citra Satelit":L.layerGroup([n,o])};try{this._map=L.map(this._elements.mapContainer,{layers:[r]}).setView(e,10),this._map.getPane("labels")||(this._map.createPane("labels"),this._map.getPane("labels").style.zIndex=350,this._map.getPane("labels").style.pointerEvents="none"),L.control.layers(i,null,{position:"bottomright"}).addTo(this._map),this._map.on("click",(function(e){t._presenter.handleMapClick(e.latlng.lat,e.latlng.lng)})),this._mapMarker||L.popup().setLatLng(e).setContent("Klik di peta untuk memilih lokasi cerita").openOn(this._map)}catch(t){this._elements.mapContainer&&(this._elements.mapContainer.innerHTML="<p>Gagal memuat peta untuk pemilihan lokasi.</p>")}}else this._elements.mapContainer&&(this._elements.mapContainer.innerHTML="<p>Gagal memuat library peta.</p>")}},{key:"toggleMapExpansionUI",value:function(){var t=this;return this._isMapExpanded=!this._isMapExpanded,this._isMapExpanded?(this._elements.mapUiWrapper.classList.add("map-ui-wrapper-expanded"),document.body.classList.add("map-fullscreen-active")):(this._elements.mapUiWrapper.classList.remove("map-ui-wrapper-expanded"),document.body.classList.remove("map-fullscreen-active")),setTimeout((function(){t._map&&t._map.invalidateSize()}),100),this._isMapExpanded}},{key:"updateToggleMapButtonTextUI",value:function(t){this._elements.toggleMapSizeButton&&(this._elements.toggleMapSizeButton.innerHTML=t?"Kecilkan Peta":"Perbesar Peta")}},{key:"getMapExpansionState",value:function(){return this._isMapExpanded}},{key:"collapseMapUI",value:function(){var t=this;this._isMapExpanded&&(this._elements.mapUiWrapper.classList.remove("map-ui-wrapper-expanded"),document.body.classList.remove("map-fullscreen-active"),this._isMapExpanded=!1,setTimeout((function(){t._map&&t._map.invalidateSize()}),100))}},{key:"cleanup",value:(r=$t(Qt().mark((function t(){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._presenter||"function"!=typeof this._presenter.handleCleanupRequest){t.next=3;break}return t.next=3,this._presenter.handleCleanupRequest();case 3:window.removeEventListener("hashchange",this._boundCleanup);case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&te(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function oe(){oe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==ne(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ne(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ie(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ae(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ie(i,n,o,a,s,"next",t)}function s(t){ie(i,n,o,a,s,"throw",t)}a(void 0)}))}}function se(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ue(n.key),n)}}function ue(t){var e=function(t){if("object"!=ne(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ne(e)?e:e+""}const ce=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._authService=r.authService},e=[{key:"onViewReady",value:(o=ae(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._authService.isUserLoggedIn();case 2:if(t.sent){t.next=5;break}return this._view.navigateToLogin(),t.abrupt("return");case 5:return t.next=7,this._loadSavedStories();case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_loadSavedStories",value:(n=ae(oe().mark((function t(){var e;return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.showLoading(!0),this._view.clearSavedStoryListAndMessages(),t.prev=2,t.next=5,s();case 5:(e=t.sent)&&e.length>0?this._view.renderSavedStoryList(e):this._view.showNoSavedStoriesMessage(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),this._view.displayMessage("Gagal memuat cerita tersimpan.",!0);case 12:return t.prev=12,this._view.showLoading(!1),t.finish(12);case 15:case"end":return t.stop()}}),t,this,[[2,9,12,15]])}))),function(){return n.apply(this,arguments)})},{key:"handleDeleteStoryRequest",value:(r=ae(oe().mark((function t(e){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.displayMessage("Menghapus cerita...",!1,!0),t.prev=1,t.next=4,c(e);case 4:return this._view.displayMessage("Cerita berhasil dihapus dari daftar tersimpan.",!1),t.next=7,this._loadSavedStories();case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),this._view.displayMessage("Gagal menghapus cerita.",!0);case 12:case"end":return t.stop()}}),t,this,[[1,9]])}))),function(t){return r.apply(this,arguments)})}],e&&se(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function le(t){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},le(t)}function he(){he=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==le(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(le(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function fe(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function pe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){fe(i,n,o,a,s,"next",t)}function s(t){fe(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,de(n.key),n)}}function de(t){var e=function(t){if("object"!=le(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==le(e)?e:e+""}const ve=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new ce(this,e),this._storyListContainerEl=null,this._loadingIndicatorEl=null,this._messageContainerEl=null},e=[{key:"render",value:(o=pe(he().mark((function t(){return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n  <section class="container saved-stories-page-content">\n    <div class="page-header-controls-wrapper">\n      <h2 class="header-page_title">Cerita Tersimpan Anda</h2>\n    </div>\n    <div id="message-display-saved" class="message-display" style="display:none; margin-bottom: 15px;"></div>\n    <div id="saved-story-list-container" class="story-list">\n      <p id="loading-indicator-saved">Memuat cerita tersimpan...</p>\n      {/* Daftar cerita tersimpan akan dirender di sini */}\n    </div>\n  </section>\n');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=pe(he().mark((function t(){var e;return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._storyListContainerEl=document.querySelector("#saved-story-list-container"),this._loadingIndicatorEl=document.querySelector("#loading-indicator-saved"),this._messageContainerEl=document.querySelector("#message-display-saved"),this._storyListContainerEl&&this._loadingIndicatorEl&&this._messageContainerEl){t.next=7;break}return(e=document.querySelector("#main-content"))&&(e.innerHTML="<p>Error: Gagal memuat komponen UI halaman cerita tersimpan.</p>"),t.abrupt("return");case 7:return t.next=9,this._presenter.onViewReady();case 9:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showLoading",value:function(t){this._loadingIndicatorEl&&(this._loadingIndicatorEl.style.display=t?"block":"none",t&&this._storyListContainerEl&&(this._storyListContainerEl.innerHTML=""))}},{key:"displayMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._messageContainerEl){this._messageContainerEl.textContent=t;var n="message-display";n+=e?" error-message":r?" info-message":" success-message",this._messageContainerEl.className=n,this._messageContainerEl.style.display="block"}}},{key:"clearMessage",value:function(){this._messageContainerEl&&(this._messageContainerEl.textContent="",this._messageContainerEl.style.display="none",this._messageContainerEl.className="message-display")}},{key:"clearSavedStoryListAndMessages",value:function(){this._storyListContainerEl&&(this._storyListContainerEl.innerHTML=""),this.clearMessage(),!this._loadingIndicatorEl||this._storyListContainerEl&&this._storyListContainerEl.innerHTML||(this._loadingIndicatorEl.style.display="block")}},{key:"renderSavedStoryList",value:function(t){var e=this;if(this._storyListContainerEl)if(this.clearMessage(),this.showLoading(!1),t&&t.length>0){this._storyListContainerEl.innerHTML="";var r=document.createDocumentFragment();t.forEach((function(t){var n=document.createElement("div");if(n.innerHTML=function(t){return'\n  <article class="story-item saved-story-item">\n    <img src="'.concat(t.photoUrl,'" alt="Foto cerita dari ').concat(t.name,": ").concat(t.description.substring(0,30),'..." class="story-item__image">\n    <div class="story-item__content">\n      <h3 class="story-item__title">').concat(t.name,'</h3>\n      <p class="story-item__date">Disimpan pada: ').concat(new Date(t.savedAt||t.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),'</p>\n      <p class="story-item__description">').concat(t.description,'</p>\n      <div class="story-item__actions" style="margin-top: 10px; display: flex; gap: 10px;">\n        <a href="#/stories/').concat(t.id,'" class="button button-primary button-sm">Lihat Detail</a>\n        <button type="button" class="button button-danger button-sm btn-delete-saved-story" data-id="').concat(t.id,'">\n          <i class="fas fa-trash-alt"></i> Hapus\n        </button>\n      </div>\n    </div>\n  </article>\n')}(t).trim(),n.firstChild){var o=n.firstChild,i=o.querySelector(".btn-delete-saved-story");i&&i.addEventListener("click",(function(r){r.stopPropagation();var n=r.target.closest("button").dataset.id;window.confirm('Anda yakin ingin menghapus cerita "'.concat(t.name,'" dari daftar tersimpan?'))&&e._presenter.handleDeleteStoryRequest(n)})),r.appendChild(o)}})),this._storyListContainerEl.appendChild(r)}else this.showNoSavedStoriesMessage()}},{key:"showNoSavedStoriesMessage",value:function(){this._storyListContainerEl&&(this._storyListContainerEl.innerHTML='<p style="text-align:center; padding: 20px;">Anda belum memiliki cerita yang disimpan.</p>')}},{key:"navigateToLogin",value:function(){window.location.hash="#/login"}},{key:"navigateToHome",value:function(){window.location.hash="#/"}},{key:"cleanup",value:(r=pe(he().mark((function t(){return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&ye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}(),me={"/":function(t){return new V(t)},"/about":function(t){return new X(t)},"/login":function(t){return new ft(t)},"/register":function(t){return new St(t)},"/stories/:id":function(t){return new Rt(t)},"/add":function(t){return new re(t)},"/saved-stories":function(t){return new ve(t)}};function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function be(){be=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==ge(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ge(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function we(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function _e(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){we(i,n,o,a,s,"next",t)}function s(t){we(i,n,o,a,s,"throw",t)}a(void 0)}))}}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Le(n.key),n)}}function ke(t,e,r){return(e=Le(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Le(t){var e=function(t){if("object"!=ge(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ge(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ge(e)?e:e+""}function Ee(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Se(t,e){return t.get(je(t,e))}function Pe(t,e,r){return t.set(je(t,e),r),r}function je(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oe=new WeakMap,Ce=new WeakMap,Te=new WeakMap,Me=new WeakMap,Ie=new WeakMap,Ne=new WeakMap,Ge=new WeakMap,Ae=new WeakMap;const Fe=function(){return t=function t(e){var r=e.navigationDrawer,n=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ee(this,Oe,null),Ee(this,Ce,null),Ee(this,Te,null),ke(this,"_currentPage",null),ke(this,"_models",null),Ee(this,Me,null),Ee(this,Ie,null),Ee(this,Ne,null),Ee(this,Ge,null),Ee(this,Ae,null),Pe(Oe,this,o),Pe(Ce,this,n),Pe(Te,this,r),this._currentPage=null,this._models={authAPI:S,authService:M},Pe(Me,this,document.querySelector("#nav-login")),Pe(Ie,this,document.querySelector("#nav-register")),Pe(Ne,this,document.querySelector("#nav-add-story")),Pe(Ge,this,document.querySelector("#nav-logout")),Pe(Ae,this,document.querySelector("#nav-saved-stories")),this._setupDrawer(),this._setupLogoutButton(),this._updateNavigationVisibility()},e=[{key:"_setupDrawer",value:function(){var t=this;Se(Ce,this).addEventListener("click",(function(e){e.stopPropagation(),Se(Te,t).classList.toggle("open")})),document.body.addEventListener("click",(function(e){Se(Te,t).contains(e.target)||Se(Ce,t).contains(e.target)||Se(Te,t).classList.remove("open");var r=e.target.closest("#nav-list a");r&&Se(Te,t).contains(r)&&Se(Te,t).classList.remove("open")}))}},{key:"_setupLogoutButton",value:function(){var t=this;Se(Ge,this)&&Se(Ge,this).addEventListener("click",function(){var e=_e(be().mark((function e(r){return be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),!t._currentPage||"function"!=typeof t._currentPage.cleanup){e.next=4;break}return e.next=4,t._currentPage.cleanup();case 4:return e.next=6,M.removeToken();case 6:return e.next=8,t._updateNavigationVisibility();case 8:window.location.hash="#/login",Se(Te,t).classList.remove("open");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_updateNavigationVisibility",value:(n=_e(be().mark((function t(){var e;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.isUserLoggedIn();case 2:e=t.sent,Se(Me,this)&&(Se(Me,this).style.display=e?"none":"block"),Se(Ie,this)&&(Se(Ie,this).style.display=e?"none":"block"),Se(Ne,this)&&(Se(Ne,this).style.display=e?"block":"none"),Se(Ge,this)&&(Se(Ge,this).style.display=e?"block":"none"),Se(Ae,this)&&(Se(Ae,this).style.display=e?"block":"none");case 8:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"renderPage",value:(r=_e(be().mark((function t(){var e,r,n,o=this;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._updateNavigationVisibility();case 2:if(i=Nt(Gt()),a=void 0,a="",i.resource&&(a=a.concat("/".concat(i.resource))),i.id&&(a=a.concat("/:id")),r=me[e=a||"/"],n=function(){var t=_e(be().mark((function t(){return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o._currentPage||"function"!=typeof o._currentPage.cleanup){t.next=3;break}return t.next=3,o._currentPage.cleanup();case 3:if(!Se(Oe,o)||!r||"function"!=typeof r){t.next=21;break}return o._currentPage=r(o._models),t.prev=5,t.next=8,o._currentPage.render();case 8:if(Se(Oe,o).innerHTML=t.sent,"function"!=typeof o._currentPage.afterRender){t.next=12;break}return t.next=12,o._currentPage.afterRender();case 12:t.next=19;break;case 14:t.prev=14,t.t0=t.catch(5),console.error("App.js: Error during page render/afterRender for ".concat(r.name||"page",":"),t.t0),Se(Oe,o).innerHTML="<h2>Terjadi kesalahan fatal saat memuat halaman ini.</h2>",o._currentPage=null;case 19:t.next=24;break;case 21:console.warn('App.js: Page factory for URL pattern "'.concat(e,'" not found or is not a valid function.')),Se(Oe,o).innerHTML='<h2>Halaman tidak ditemukan (404)</h2><p><a href="#/">Kembali ke Beranda</a></p>',o._currentPage=null;case 24:case"end":return t.stop()}}),t,null,[[5,14]])})));return function(){return t.apply(this,arguments)}}(),!document.startViewTransition){t.next=9;break}document.startViewTransition(_e(be().mark((function t(){return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n();case 2:case"end":return t.stop()}}),t)})))),t.next=11;break;case 9:return t.next=11,n();case 11:case"end":return t.stop()}var i,a}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&xe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function Ue(){Ue=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(n||[]);return o(a,"_invoke",{value:S(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(T([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=h(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==De(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?d:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=d,n.method="throw",n.arg=c.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(De(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),c(k,u,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Be(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function qe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Be(i,n,o,a,s,"next",t)}function s(t){Be(i,n,o,a,s,"throw",t)}a(void 0)}))}}document.addEventListener("DOMContentLoaded",qe(Ue().mark((function t(){var e,r,n,o;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Fe({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")}),t.next=3,e.renderPage();case 3:window.addEventListener("hashchange",qe(Ue().mark((function t(){return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderPage();case 2:case"end":return t.stop()}}),t)})))),r=document.querySelector(".skip-to-content"),n=document.querySelector("#main-content"),r&&n?r.addEventListener("click",(function(t){t.preventDefault(),this.blur(),n.focus()})):(r||console.warn("Peringatan: Elemen tautan .skip-to-content tidak ditemukan di DOM."),n||console.warn("Peringatan: Elemen #main-content tidak ditemukan di DOM.")),(o=document.querySelector("#current-year"))&&(o.textContent=(new Date).getFullYear());case 9:case"end":return t.stop()}}),t)}))))})();